{"version":3,"sources":["webpack:///./src/layouts/cv2612.js","webpack:///./src/components/cv2612/utils/patches-utils.js","webpack:///./src/components/cv2612/context.js","webpack:///./src/components/cv2612/utils/obj_diff.js","webpack:///./src/components/cv2612/emulator.js","webpack:///./src/components/cv2612/midi.js","webpack:///./src/components/cv2612/sequencer.js","webpack:///./src/components/cv2612/patches.js","webpack:///./src/components/cv2612/envelope.js","webpack:///./src/components/cv2612/slider.js","webpack:///./src/components/cv2612/operator.js","webpack:///./src/components/cv2612/channel.js","webpack:///./src/components/cv2612/utils/algorithmAscii.js","webpack:///./src/components/cv2612/channels.js","webpack:///./src/components/cv2612/device.js","webpack:///./src/pages/cv2612.js","webpack:///./.cache/gatsby-browser-entry.js","webpack:///./.cache/public-page-renderer.js","webpack:///./src/components/seo.js","webpack:///./.cache/public-page-renderer-prod.js","webpack:///./src/components/header/brand.js"],"names":["Layout","render","children","this","props","react_default","a","createElement","id","Helmet_default","bodyAttributes","class","brand","title","React","Component","dmp2patch","name","d","params","ch","op","o","replace","emptyParams","bitness","param","bits","_i","_groups","length","some","k","endsWith","console","log","emptyMapping","mapping","key","cc","CV2612Context","createContext","ctrlmap","Consumer","CV2612Provider","_this","_React$Component","call","handleCC","val","state","activeParameter","learning","Object","assign","setState","reactLocalStorage","setObject","_Object$entries","entries","_Object$entries$_i","m","step","Math","pow","v","floor","updateParam","toggleLearning","sendParameter","code","value","parts","split","parseInt","pId","indexOf","chan","addr","midi","sendSysexSet","emulator","update","sendParameters","_i2","_Object$entries2","_Object$entries2$_i","setActiveParameter","updateParams","newParams","_i3","_Object$entries3","_Object$entries3$_i","filterChannel","filters","envelopes","soundOn","componentDidMount","savedMapping","getObject","keys","_i4","_Object$entries4","_Object$entries4$_i","componentWillUnmount","componentDidUpdate","prevProps","prevState","b","diff","reduce","_Object$assign","updateChannelsIfOmniChanged","updateEnvelopesIfChanged","omnis","filter","startsWith","_iterator","_isArray","Array","isArray","_i5","Symbol","iterator","_ref","next","done","p","i","_this2","env_params","envs","acc","push","substring","x","forEach","e","env","calculateEnvelopePoints","x1","round","ar","y1","tl","x2","d1","y2","sl","x3","d2","rr","map","join","Provider","kb","AudioKeys","polyphony","rows","priority","Emulator","audioCtx","noteOn","note","f","onKeyDown","frequency","noteOff","onKeyUp","context","sendMidi","ym2612Node","notes","setFrequency","keyOn","splice","keyOff","ch_off","mask","size","shift","write","onToggleSoundClick","preventDefault","disconnect","destination","initialize","connect","down","up","_listeners","AudioContext","audioWorklet","addModule","then","AudioWorkletNode","outputChannelCount","port","onmessage","event","data","block","freq","address","toString","postMessage","href","onClick","fa","contextType","Midi","midiInId","midiOutId","midiAccess","onChangeMidiIn","ev","setMidiIn","target","onChangeMidiOut","setMidiOut","sendSysex","msg","chksum","ma","midiOut","outputs","get","send","onMIDIStateChange","refreshMidiPorts","onMIDIMessage","from","type","lastMsg","JSON","stringify","onLearnClick","onPanicClick","onClearClick","toggleSound","midiIns","midiOuts","navigator","requestMIDIAccess","sysex","onstatechange","set","sendHandshake","midiIn","inputs","onmidimessage","values","includes","className","onChange","seqTimeOut","seqNote","seqNoteOn","Sequencer","sequencerOn","sequencerStop","clearTimeout","sequencerTick","sort","random","duration","setTimeout","Patches","addDmpPatch","patch","patches","save","onChangeHandler","_loop","fr","FileReader","onload","Int8Array","result","readAsArrayBuffer","files","current","blur","onSave","onCreate","prompt","onDelete","onLoadDefaults","loadDefaultPatches","onLeftClick","onRightClick","onUploadClick","refs","file","click","r","XMLHttpRequest","onreadystatechange","readyState","status","_loop2","_isArray2","_iterator2","_ref2","responseType","response","open","encodeURI","responseText","style","display","ref","accept","multiple","Envelope","height","width","viewBox","xmlns","points","defaultProps","Slider","componentWillMount","max","mapped","min","Operator","slider","envelope","Channel","algorithm","algorithmAscii","operator","Channels","onFilterChannel","attributes","Fragment","channel","Device","sequencer","cv2612_patches","channels","CV2612Index","cv2612","location","seo","device","__webpack_require__","__webpack_exports__","StaticQuery","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","gatsby_link__WEBPACK_IMPORTED_MODULE_2__","gatsby_link__WEBPACK_IMPORTED_MODULE_2___default","StaticQueryContext","staticQueryData","query","propTypes","PropTypes","object","string","isRequired","func","module","exports","require","default","SEO","description","lang","meta","keywords","react__WEBPACK_IMPORTED_MODULE_1___default","gatsby__WEBPACK_IMPORTED_MODULE_4__","detailsQuery","metaDescription","site","siteMetadata","react_helmet__WEBPACK_IMPORTED_MODULE_3___default","htmlAttributes","titleTemplate","content","property","author","concat","_public_static_d_1025518380_json__WEBPACK_IMPORTED_MODULE_0__","array","arrayOf","ProdPageRenderer","pageResources","loader","getResourcesForPathnameSync","pathname","InternalPageRenderer","json","shape","swaps","Brand","getDiff","timer","to","intervalId","setInterval","bind","clearInterval","react__WEBPACK_IMPORTED_MODULE_2___default","gatsby__WEBPACK_IMPORTED_MODULE_3__"],"mappings":"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","file":"component---src-pages-cv-2612-js-0c5e7781297765a345c8.js","sourcesContent":["import React from \"react\"\nimport Brand from \"../components/header/brand\"\nimport Helmet from \"react-helmet\"\n\nclass Layout extends React.Component {\n\n  render() {\n    const { children } = this.props\n\n    return (\n      <div id=\"app\">\n        <header>\n          <Helmet bodyAttributes={{class:'dark cv2612'}} />\n          <Brand title=\"diego dorado\"/>\n        </header>\n        <main>{children}</main>\n      </div>\n    )\n  }\n}\n\nexport default Layout\n","export const dmp2patch = (name,d) =>{\n    //version 9 or 11, genesis, FM patch\n    if( (d[0]===0x09 && d[1]===0x01 && d[2]===0x00)\n        || ( d[0]===0x0B && d[1]===0x02 && d[2]===0x01) ){\n\n        /*\n\n        http://www.deflemask.com/DMP_SPECS.txt\n\n        1 Byte: LFO (FMS on YM2612, PMS on YM2151)\n        1 Byte: FB\n        1 Byte: ALG\n        1 Byte: LFO2 (AMS on YM2612, AMS on YM2151)\n        Repeat this TOTAL_OPERATORS times\n          1 Byte: MULT\n          1 Byte: TL\n          1 Byte: AR\n          1 Byte: DR\n          1 Byte: SL\n          1 Byte: RR\n          1 Byte: AM\n          1 Byte: RS\n          1 Byte: DT (DT2<<4 | DT on YM2151)\n          1 Byte: D2R\n          1 Byte: SSGEG_Enabled <<3 | SSGEG\n          */\n          const params = {}\n          params[`6_4_lfo`] = 0\n          for(let ch=0;ch<=6;ch++){\n            //repeat for 6 channels, and omni channel too\n            params[`${ch}_4_fms`] = d[3]\n            params[`${ch}_4_fb`] = d[4]\n            params[`${ch}_4_al`] = d[5]\n            params[`${ch}_4_ams`] = d[6]\n            params[`${ch}_4_st`] = 3\n            for(let op=0;op<=4;op++){\n              //use first op as omni op\n              const o = (op===4?0:op)*11+7\n              params[`${ch}_${op}_mul`] = d[o+0]\n              params[`${ch}_${op}_tl`] = d[o+1]\n              params[`${ch}_${op}_ar`] = d[o+2]\n              params[`${ch}_${op}_d1`] = d[o+3]\n              params[`${ch}_${op}_sl`] = d[o+4]\n              params[`${ch}_${op}_rr`] = d[o+5]\n              params[`${ch}_${op}_am`] = d[o+6]\n              params[`${ch}_${op}_rs`] = d[o+7]\n              params[`${ch}_${op}_det`] = d[o+8]\n              params[`${ch}_${op}_d2`] = d[o+9]\n            }\n          }\n\n          return {name: name.replace('.dmp',''), params: params}\n    }\n    //else\n    return null\n\n}\n\n\nexport const emptyParams = () =>{\n  const params = {}\n  params[`6_4_lfo`] = 0\n  params[`6_4_dly`] = 0\n  params[`6_4_dlyt`] = 0\n  params[`6_4_dlyf`] = 0\n  for(let ch=0;ch<=6;ch++){\n    //repeat for 6 channels, and omni channel too\n    params[`${ch}_4_fms`] = 0\n    params[`${ch}_4_fb`] = 0\n    params[`${ch}_4_al`] = 0\n    params[`${ch}_4_ams`] = 0\n    params[`${ch}_4_st`] = 3\n    for(let op=0;op<=4;op++){\n      params[`${ch}_${op}_mul`] = 0\n      params[`${ch}_${op}_tl`] = 0\n      params[`${ch}_${op}_ar`] = 0\n      params[`${ch}_${op}_d1`] = 0\n      params[`${ch}_${op}_sl`] = 0\n      params[`${ch}_${op}_rr`] = 0\n      params[`${ch}_${op}_am`] = 0\n      params[`${ch}_${op}_rs`] = 0\n      params[`${ch}_${op}_det`] = 0\n      params[`${ch}_${op}_d2`] = 0\n    }\n  }\n  return params\n}\n\n\nconst bitness = (param) =>{\n  const groups = [\n    ['am'],\n    ['rs','st','ams'],\n    ['det','al','fb','fms','lfo'],\n    ['sl','rr','mul'],\n    ['ar','d2','d1'],\n    [],\n    ['tl'],\n    ['dly','dlyt','dlyf'],\n  ]\n  let bits = 1\n  for(let group of groups){\n    if (group.some((k) => param.endsWith(k)))\n      return bits\n    bits++\n  }\n  console.log('invalid param',param)\n  return 0\n}\n\nexport const emptyMapping = () =>{\n  const mapping = emptyParams()\n  for (let key in mapping) {\n    mapping[key] = {cc:null, ch:null, bits: bitness(key)}\n  }\n  return mapping\n}\n","import React from \"react\"\nimport {emptyParams, emptyMapping} from \"./utils/patches-utils\"\nimport obj_diff from \"./utils/obj_diff\"\nimport {reactLocalStorage} from 'reactjs-localstorage'\n\nexport const CV2612Context = React.createContext()\nexport const CV2612Consumer = CV2612Context.Consumer\n\nconst ctrlmap = ['ar','d1','sl','d2','rr','tl','mul','det','rs','am','al','fb','ams','fms','st','lfo']\n\n// Create the provider using a traditional React.Component class\nclass CV2612Provider extends React.Component {\n\n  constructor(props){\n    super(props);\n\n    this.state = {\n      midi: null,\n      emulator: null,\n      learning: false,\n      activeParameter: null,\n      envelopes: {},\n      params: emptyParams(),\n      mapping: emptyMapping(),\n      filters:{ch: 6},\n      soundOn: false,\n      setActiveParameter: this.setActiveParameter,\n      updateParam: this.updateParam,\n      updateParams: this.updateParams,\n      filterChannel: this.filterChannel,\n      toggleLearning: this.toggleLearning,\n      handleCC: this.handleCC,\n      sendParameters : this.sendParameters,\n    }\n  }\n\n  componentDidMount(){\n    const savedMapping = reactLocalStorage.getObject('mapping',{})\n    if(Object.keys(savedMapping).length>0){\n      let mapping = {...this.state.mapping}\n      for (let [code, value] of Object.entries(savedMapping)) {\n        mapping[code] = value\n      }\n      this.setState({mapping:mapping})\n    }\n  }\n\n  componentWillUnmount() {\n    //this.state.emulator.destroy()\n  }\n\n  handleCC = (ch,cc, val)=>{\n    const k = this.state.activeParameter\n    if(this.state.mapping[k] && this.state.learning){\n      let mapping = {...this.state.mapping}\n      if(mapping[k].ch !== ch && mapping[k].cc !== cc){\n        mapping[k].ch = ch\n        mapping[k].cc = cc\n        this.setState({mapping: mapping})\n        reactLocalStorage.setObject('mapping',mapping)\n      }\n    }\n\n    for (let [k, m] of Object.entries(this.state.mapping)) {\n      if(m.cc === cc && m.ch === ch){\n        const resolution = Math.pow(2,m.bits)\n        const step = 128/resolution\n        const v = Math.floor(val/step)\n        this.updateParam(k,v)\n      }\n    }\n\n  }\n\n  toggleLearning = () =>{\n    this.setState({learning: !this.state.learning})\n  }\n\n  sendParameter = (code, value) => {\n    const parts = code.split('_')\n    const ch = parseInt(parts[0])\n    const op = parseInt(parts[1])\n    const param = parts[2]\n    const pId = ctrlmap.indexOf(param)\n    //console.log(pId,param,code, [ch,op,pId,value])\n    if(pId!==-1){\n\n       //todo: implement omni channel on chip side\n       // and avoid resending parameters triggered by omni channel\n      if(ch===6){\n        for(let chan=0;chan<5;chan++){\n          const addr = [chan,op,pId]\n          this.state.midi.sendSysexSet(addr,value)\n        }\n      }else{\n        const addr = [ch,op,pId]\n        this.state.midi.sendSysexSet(addr,value)\n      }\n    }\n    this.state.emulator.update(ch,op,param,value,this.state.params)\n  }\n\n\n  sendParameters = (params) => {\n    const count = Object.entries(params).length\n\n    for (let [code, value] of Object.entries(params)) {\n      this.sendParameter(code,value)\n    }\n\n  }\n\n\n\n  setActiveParameter = (param) => {\n    this.setState({activeParameter: param})\n  }\n\n  updateParam = (code,value) => {\n    let params = {...this.state.params}\n    params[code] = value\n    this.setState({params: params})\n  }\n\n  updateParams = (newParams) => {\n    let params = {...this.state.params}\n    for (let [code, value] of Object.entries(newParams)) {\n      params[code] = value\n    }\n    this.setState({params: params})\n  }\n\n  filterChannel= (ch) => {\n    let filters = {...this.state.filters}\n    filters.ch = ch\n    this.setState({filters})\n  }\n\n\n  componentDidUpdate(prevProps, prevState) {\n    //which params have changed?\n    const diff = obj_diff(prevState.params, this.state.params)\n    if(Object.entries(diff).length>0){\n      this.sendParameters(diff)\n      this.updateChannelsIfOmniChanged(diff)\n      this.updateEnvelopesIfChanged(diff)\n    }\n  }\n\n\n\n  updateChannelsIfOmniChanged(diff){\n\n    // if any omni channel parameter has changed\n\n    //todo: exclude lfo\n    const omnis = Object.keys(diff).filter((a) => a.startsWith('6'))\n\n    if(omnis.length>0){\n      const params = {}\n\n      for(let o of omnis){\n        const p = o.split('_')\n        for(let i=0;i<6;i++){\n          params[`${i}_${p[1]}_${p[2]}`] = diff[o]\n        }\n      }\n\n      this.updateParams(params)\n    }\n  }\n\n\n  updateEnvelopesIfChanged(diff){\n    //check if any envelope should change\n    const env_params = ['ar','d1','sl','d2','rr','tl']\n    const envs = Object.keys(diff).reduce((acc, key) => {\n      if (env_params.some((a) => key.endsWith(a)))\n        //accumulates channel_operator to identify envelope to update\n        acc.push(key.substring(0,3))\n      return acc\n    }, [])\n      .filter((x, i, a) => a.indexOf(x) === i) //filter unique\n\n    //update envelopes?\n    if(envs.length){\n      let envelopes = {...this.state.envelopes}\n      envs.forEach( (e) => {\n        const env = env_params\n          .reduce((acc,i)=>{acc[`${i}`]=this.state.params[`${e}_${i}`];return acc},{})\n        envelopes[e] = this.calculateEnvelopePoints(env)\n      })\n      this.setState({envelopes: envelopes})\n    }\n  }\n\n  calculateEnvelopePoints(env){\n    const x1 = Math.round((31-env.ar)/31*100)\n    const y1 = Math.round(env.tl/127*100)\n    const x2 = Math.round(x1+(31-env.d1)/31*100)\n    const y2 = Math.round(y1+(100-y1)*(env.sl/15))\n    const x3 = Math.round(x2+(31-env.d2)/31*50+50)\n    const y3 = Math.round(y2+(100-y2)*(0.5*(env.d2/31)))\n    const x4 = Math.round(x3+(31-env.rr)/31*100)\n\n    const points = [\n        [0,100],\n        [x1,y1],\n        [x2,y2],\n        [x3,y3],\n        [x4,100]\n      ]\n    return points.map((p)=>p.join(',')).join(' ').replace(/NaN/g,'0')\n  }\n\n\n  render () {\n    return (\n      // value prop is where we define what values\n      // that are accessible to consumer components\n       <CV2612Context.Provider value={this.state}>\n        {this.props.children}\n      </CV2612Context.Provider>\n    )\n  }\n}\n\nexport default CV2612Provider\n","export default function obj_diff(a,b){\n  return Object.keys(b).reduce((diff, key) => {\n    if (a[key] === b[key]) return diff\n    return {\n      ...diff,\n      [key]: b[key]\n    }\n  }, {})\n}\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport AudioKeys from 'audiokeys'\nimport { FaVolume,\n         FaVolumeSlash\n        } from 'react-icons/fa'\n\n//todo: update for all 6 channels\n//todo: unload properly\n\nconst kb = new AudioKeys({polyphony: 1,rows: 1,priority: 'last'})\n\n\nclass Emulator extends React.Component {\n  static contextType = CV2612Context\n  audioCtx = null\n\n  constructor(props) {\n    super(props)\n    this.state = {soundOn: false}\n  }\n\n  componentDidMount(){\n    this.notes = []\n    this.context.emulator = this\n    kb.down(this.onKeyDown)\n    kb.up(this.onKeyUp)\n  }\n\n\n  componentWillUnmount(){\n    if(this.audioCtx!==null){\n      this.audioCtx = null\n    }\n    kb._listeners.down = []\n    kb._listeners.up = []\n    console.log(kb._listeners)\n  }\n\n\n\n  initialize(){\n\n    this.audioCtx = new AudioContext()\n\n    this.audioCtx.audioWorklet.addModule('/cv2612/ym2612-processor.js').then(() => {\n      this.ym2612Node = new AudioWorkletNode(this.audioCtx, 'ym2612-generator', { outputChannelCount: [2] })\n      this.ym2612Node.port.onmessage = (event) => {console.log(event.data)}\n      this.ym2612Node.connect(this.audioCtx.destination)\n\n      this.write(0x27,0x00) //chan3 normal mode\n      this.write(0x28,0x00)\n      // load all patch params\n      this.context.sendParameters(this.context.params)\n    })\n  }\n\n\n  noteOn = (note) => {\n    const f = ( Math.pow(2, ( note-69 ) / 12) ) * 440.0\n    this.onKeyDown({note:note,frequency:f})\n  }\n\n  noteOff = (note) => {\n    this.onKeyUp({note:note})\n  }\n\n  onKeyDown = (note) => {\n    this.context.midi.sendMidi([0x90,note.note,0x70])\n\n    if(!this.ym2612Node)\n      return\n\n\n    if(this.notes.indexOf(note.note)===-1)\n      this.notes.push(note.note)\n\n    this.setFrequency(note.frequency)\n\n    if(this.notes.length===1){\n      this.keyOn()\n    }\n  }\n\n  onKeyUp = (note) => {\n    this.context.midi.sendMidi([0x80,note.note,0x00])\n\n    if(!this.ym2612Node)\n      return\n\n\n    for( let i = 0; i < this.notes.length; i++){\n       if ( this.notes[i] === note.note)\n         this.notes.splice(i, 1)\n    }\n\n    if(this.notes.length===0){\n      this.keyOff()\n    }\n  }\n\n  setFrequency(f) {\n    let block = 2\n    while (f >= 2048) {\n      f /= 2\n      block++\n    }\n    const freq = parseInt(f)\n\n    for(let chan=0;chan<6;chan++){\n      const ch_off = (Math.floor(chan/3) * 0x100 + chan%3 )\n      this.write(0xA4+ch_off, ((freq >> 8) & 0x07) | ( ( block & 0x07 ) << 3))\n      this.write(0xA0+ch_off, freq&0xFF)\n    }\n  }\n\n\n  keyOn() {\n    for(let chan=0;chan<6;chan++)\n      this.write(0x28, 0xF0 + (Math.floor(chan/3) * 4 + chan%3 ) )\n  }\n\n  keyOff() {\n    for(let chan=0;chan<6;chan++)\n      this.write(0x28, 0x00 + (Math.floor(chan/3) * 4 + chan%3 ) )\n  }\n\n\n  write(address,value){\n    if(!this.ym2612Node)\n      return\n\n    console.log(address.toString(16),value.toString(16))\n    this.ym2612Node.port.postMessage([address,value])\n  }\n\n\n  update = (ch,op,param,value,params) =>{\n\n    if(ch===6){\n      for(let chan=0;chan<6;chan++)\n        this.update(chan,op,param,value,params)\n      return\n    }\n\n    const ch_off = (Math.floor(ch/3) * 0x100 + ch%3 )\n    const mask = (key,size,shift) =>{\n      return (params[`${ch}_${op}_${key}`] & (Math.pow(2,size)-1))<<shift\n    }\n\n    if(param==='lfo' ){\n      //todo: disable lfo when value is 0?\n      this.write(0x22, (0x01<<3) | (value & 0x07));\n    }\n    else if(param==='det' || param==='mul' ){\n      const v = mask('det',3,4)|mask('mul',4,0)\n      this.write(0x30+4*op+ch_off, v)\n    }\n    else if(param==='tl'){\n      const v = mask('tl',7,0)\n      this.write(0x40+4*op+ch_off, v)\n    }\n    else if(param==='rs' || param==='ar' ){\n      const v = mask('rs',2,6)|mask('ar',5,0)\n      this.write(0x50+4*op+ch_off, v)\n    }\n    else if(param==='am' || param==='d1' ){\n      const v = mask('am',1,7)|mask('d1',5,0)\n      this.write(0x60+4*op+ch_off, v)\n    }\n    else if(param==='d2' ){\n      const v = mask('d2',5,0)\n      this.write(0x70+4*op+ch_off, v)\n    }\n    else if(param==='sl' || param==='rr' ){\n      const v = mask('sl',4,4)|mask('rr',4,0)\n      this.write(0x80+4*op+ch_off, v)\n    }\n    else if(param==='al' || param==='fb' ){\n      const v = mask('fb',3,3)|mask('al',3,0)\n      this.write(0xB0+ch_off, v)\n    }\n    else if(param==='st' || param==='ams'|| param==='fms' ){\n      const v = mask('st',2,6)|mask('ams',2,4)|mask('fms',3,0)\n      this.write(0xB4+ch_off, v)\n    }\n  }\n\n  onToggleSoundClick = (e) => {\n    e.preventDefault()\n    if(this.state.soundOn){\n      this.ym2612Node.disconnect(this.audioCtx.destination)\n    }else{\n      if (this.audioCtx===null)\n        this.initialize()\n      else\n        this.ym2612Node.connect(this.audioCtx.destination)\n    }\n    this.setState({soundOn: !this.state.soundOn})\n  }\n\n  render() {\n    return (\n      <a href=\"/\" title=\"Toggles Sound\" onClick={this.onToggleSoundClick}>{this.state.soundOn ?<FaVolume/>:<FaVolumeSlash/>}</a>\n    )\n  }\n\n}\n\nexport default Emulator;\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport {reactLocalStorage} from 'reactjs-localstorage'\nimport Emulator from './emulator'\nimport { FaSlidersH,\n         FaTrash,\n         FaGhost\n        } from 'react-icons/fa'\n\n\n//todo: move midi stuff to midi-utils.js\n//warning: this component cannot be unmounted\nclass Midi extends React.Component {\n  static contextType = CV2612Context\n\n  midiInId = ''\n  midiOutId = ''\n  midiAccess= null\n\n  constructor(props) {\n    super(props)\n    this.state = {\n      midiIns: [],\n      midiOuts: [],\n    }\n\n  }\n\n  componentDidMount(){\n    navigator.requestMIDIAccess( { sysex: true }).then(\n      (ma)=>{\n        this.midiAccess = ma\n        this.refreshMidiPorts()\n        ma.onstatechange = this.onMIDIStateChange\n      },()=>console.log('Could not access your MIDI devices.'))\n\n    this.context.midi = this\n  }\n\n\n  onChangeMidiIn = (ev) => {\n    this.setMidiIn(ev.target.value)\n  }\n\n  onChangeMidiOut = (ev) => {\n    this.setMidiOut(ev.target.value)\n  }\n\n  setMidiOut(id){\n    this.midiOutId = id\n    this.setState({midiOutId: id})\n    reactLocalStorage.set('midiOutId',id)\n    this.sendHandshake()\n  }\n\n  setMidiIn(id){\n    this.midiInId = id\n    this.setState({midiInId: id})\n    reactLocalStorage.set('midiInId',id)\n    const midiIn = this.midiAccess.inputs.get(id)\n    if(midiIn){\n      midiIn.onmidimessage = this.onMIDIMessage\n    }else{\n      console.log('Midi In error')\n    }\n  }\n\n  sendHandshake(){\n    // device ID request\n    const msg = [0xF0, 0x7E, 0x7F, 0x06, 0x01, 0xF7]\n    this.sendSysex(msg)\n\n  }\n\n  sendSysex = (data) => {\n    this.sendMidi(data)\n  }\n\n  sendSysexSet = (addr,value) => {\n    // send data header\n    const msg = [0xF0, 0x41, 0x26, 0x12, 0x12]\n    // part 6 is a three bytes address\n    // part 7 is the data itself, in this case, a single 7-bit\n    // part 8 is the cheksum , 0x7F - the sum of address and value\n    const chksum = 0x7F - ((addr[0]+addr[1]+addr[2]+value)%0x7F)\n    msg.push(addr[0])\n    msg.push(addr[1])\n    msg.push(addr[2])\n    msg.push(value)\n    msg.push(chksum)\n    // part 9  is the end byte\n    msg.push(0xF7)\n    this.sendSysex(msg)\n  }\n\n  sendMidi = (data) => {\n    const ma = this.midiAccess\n    if(ma===null){\n      return\n    }\n    const midiOut = ma.outputs.get(this.midiOutId)\n    if(midiOut){\n      midiOut.send(data)\n    }else{\n      console.log('No Midi Out')\n    }\n  }\n\n  onMIDIStateChange = (e) => {\n    this.refreshMidiPorts()\n  }\n\n  refreshMidiPorts() {\n    const ma = this.midiAccess\n    const inputs = Array.from(ma.inputs.values())\n    const outputs = Array.from(ma.outputs.values())\n    this.setState({midiIns:inputs, midiOuts:outputs})\n\n    if(inputs.length){\n      let id = reactLocalStorage.get('midiInId')\n      // is last id still available??\n      if( !inputs.map(i=>i.id).includes(id) ){\n        id = inputs[0].id\n      }\n      if(id !== this.midiInId)\n        this.setMidiIn(id)\n    }\n    if(outputs.length){\n      let id = reactLocalStorage.get('midiOutId')\n      // is last id still available??\n      if( !outputs.map(o=>o.id).includes(id) ){\n        id = outputs[0].id\n      }\n      if(id !== this.midiOutId)\n        this.setMidiOut(id)\n    }\n  }\n\n  onMIDIMessage = (msg) => {\n\n    if(msg.target.id !== this.midiInId)\n      return\n\n    const data = Array.from(msg.data)\n    const type = data[0] & 0xf0\n\n    if(type===0xF0){ // sysex\n      const idReply = [0xF0, 0x7E, 0x00, 0x06, 0x02,  //identity reply\n          0x26, 0x26, 0x12, 0x00, 0x00, // ID - family code - model number\n          0x01, 0x00, 0x00, 0x00, 0xF7] //version - end\n      if(JSON.stringify(data) === JSON.stringify(idReply)){\n        this.setState({lastMsg: `CV2612 found!` })\n      }else{\n        console.log('sysex reply ')\n        console.log(data)\n      }\n      return\n    }\n\n    if(type === 0xB0){\n      const ch = data[0] & 0x0f\n      const cc = data[1] & 0x7f\n      const val = data[2] & 0x7f\n      this.context.handleCC(ch,cc, val)\n      this.setState({lastMsg: `${type},${ch},${cc},${val}` })\n    }\n\n    // resend noteon/off events\n    if(type === 0x80 || type === 0x90){\n      this.sendMidi(data)\n      if(type === 0x90){\n        this.context.emulator.noteOn(data[1])\n      }else{\n        this.context.emulator.noteOff(data[1])\n      }\n    }\n\n  }\n\n  onLearnClick = (e) => {\n    e.preventDefault()\n    this.context.toggleLearning()\n  }\n\n  onPanicClick = (e) => {\n    e.preventDefault()\n    this.sendMidi([0xFF])\n  }\n\n  onClearClick = (e) => {\n    e.preventDefault()\n    this.sendSysexSet([0x06,0x04,0x11],0x00)\n  }\n\n  onToggleSoundClick = (e) => {\n    e.preventDefault()\n    this.context.toggleSound()\n  }\n\n  render() {\n    return (\n      <div>\n        <nav className=\"midi\">\n          <span>In</span>\n          <select value={this.state.midiInId} onChange={this.onChangeMidiIn}>\n            {this.state.midiIns.map((i) =><option key={i.id} value={i.id}>{i.name}</option>)}\n          </select>\n          <span>Out</span>\n          <select value={this.state.midiOutId} onChange={this.onChangeMidiOut}>\n            {this.state.midiOuts.map((o) =><option key={o.id} value={o.id}>{o.name}</option>)}\n          </select>\n          <a className={this.context.learning ? 'learning':''} href=\"/\" title=\"Click to Learn\" onClick={this.onLearnClick}><FaSlidersH/></a>\n          <a href=\"/\" title=\"Click if panic\" onClick={this.onPanicClick}><FaGhost/></a>\n          <a href=\"/\" title=\"Click to clear midi mapping\" onClick={this.onClearClick}><FaTrash/></a>\n          <Emulator />\n        </nav>\n      </div>\n    )\n  }\n}\n\nexport default Midi;\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\n\nlet seqTimeOut\nlet seqNote = 0\nlet seqNoteOn = false\n\nclass Sequencer extends React.Component {\n  static contextType = CV2612Context\n\n  constructor(props){\n    super(props);\n    this.state = {\n      sequencerOn: false,\n    }\n  }\n\n  componentWillUnmount() {\n    this.sequencerStop()\n  }\n\n\n  onClick = (e) => {\n    e.preventDefault()\n    this.setState({sequencerOn: !this.state.sequencerOn})\n  }\n\n  sequencerStop() {\n    clearTimeout(seqTimeOut)\n    if(seqNoteOn){\n      this.context.midi.sendMidi([0x80,seqNote,0x00])\n      seqNoteOn = false\n    }\n  }\n\n  sequencerTick() {\n    if(seqNoteOn){\n      this.context.midi.sendMidi([0x80,seqNote,0x00])\n      seqNoteOn = false\n    }\n    else{\n      //sets a random note\n      seqNote = [0,3,5,7,10].sort(() => Math.random() - 0.5)[0]\n                     + (3+Math.floor(Math.random()*5))*12\n      this.context.midi.sendMidi([0x90,seqNote,100])\n      seqNoteOn = true\n    }\n\n    if(this.state.sequencerOn){\n      const duration = 500/Math.pow(2,Math.floor(Math.random()*5))\n      seqTimeOut = setTimeout(()=> this.sequencerTick(), duration)\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if(prevState.sequencerOn !== this.state.sequencerOn){\n      if(this.state.sequencerOn){\n        this.sequencerTick()\n      }else{\n        this.sequencerStop()\n      }\n    }\n  }\n\n  render() {\n    //todo: fixme\n    return null\n    return (\n      <button onClick={this.onClick}>{this.state.sequencerOn ? 'Stop Seq':'Start Seq'}</button>\n    )\n  }\n}\n\n\nexport default Sequencer\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport {dmp2patch, emptyParams} from \"./utils/patches-utils\"\n\nimport {reactLocalStorage} from 'reactjs-localstorage'\nimport { FaPlus,\n         FaBackspace,\n         FaCaretLeft,\n         FaCaretRight,\n         FaBomb,\n         FaSave,\n         FaUpload\n        } from 'react-icons/fa'\n\n\nclass Patches extends React.Component {\n  static contextType = CV2612Context\n\n  constructor(props){\n    super(props)\n    this.state = {\n      patches: [{name: 'empty', params: emptyParams()}],\n      current: 0,\n    }\n  }\n\n  componentDidMount(){\n    const patches = reactLocalStorage.getObject('patches',[])\n    if(patches.length===0 || Object.keys(patches).length===0){\n      this.loadDefaultPatches()\n    }else{\n      this.setState({patches:patches})\n    }\n  }\n\n  save(patches){\n    reactLocalStorage.setObject('patches',patches)\n    this.setState({patches:patches})\n  }\n\n  loadDefaultPatches(){\n    //empty previous patches\n    this.save([])\n\n    const r = new XMLHttpRequest()\n    r.onreadystatechange = (ev) => {\n      if(r.readyState === 4 && r.status === 200) {\n        const insts = r.responseText.split(/\\r?\\n/).filter( x => x.length>1)\n        for(const i of insts){\n          const r = new XMLHttpRequest()\n          r.responseType = 'arraybuffer'\n          r.onreadystatechange = (ev) => {\n            if(r.readyState === 4 && r.status === 200) {\n              const d = new Int8Array(r.response)\n              this.addDmpPatch(i,d)\n            }\n          }\n          r.open('GET',encodeURI(`/cv2612/instruments/${i}`))\n          r.send(null)\n        }\n      }\n    }\n    r.open('GET', '/cv2612/instruments/index.txt')\n    r.send(null)\n  }\n\n  //todo: load to all voices or current voice\n  componentDidUpdate(prevProps, prevState) {\n    //fixme: if i delete a patch, current doesnt change...\n    if(prevState.current !== this.state.current){\n      const i = parseInt(this.state.current)\n      const patch = this.state.patches[i]\n      if(patch)\n        this.context.updateParams(patch.params)\n    }\n\n    if(prevState.patches.length !== this.state.patches.length){\n      this.setState({current:0})\n      const patch = this.state.patches[0]\n      if(patch)\n        this.context.updateParams(patch.params)\n    }\n\n  }\n\n\n  addDmpPatch = (name, d) => {\n    const patch = dmp2patch(name,d)\n    if(patch !== null){\n      //is there any risk here?\n      const patches = this.state.patches\n      patches.push(patch)\n      this.save(patches)\n    }\n  }\n\n  onChangeHandler = (ev) => {\n    for(const f of ev.target.files){\n      const fr = new FileReader()\n      fr.onload = () =>{\n        const d = new Int8Array(fr.result)\n        this.addDmpPatch(f.name,d)\n      }\n      fr.readAsArrayBuffer(f)\n    }\n  }\n\n  onChange = (ev) => {\n    this.setState({current: ev.target.value})\n    ev.target.blur()\n  }\n\n  onSave = (e) => {\n    e.preventDefault()\n    if(this.state.patches.length===0)\n      return\n\n    const patches = this.state.patches\n    const i = parseInt(this.state.current)\n    patches[i].params = this.context.params\n    this.save(patches)\n\n  }\n\n  onCreate = (e) => {\n    e.preventDefault()\n    let patch = prompt(\"Name your patch\")\n    if (patch !== null && patch !== \"\") {\n      const patches = this.state.patches\n      patches.push({name:patch, params: this.context.params})\n      this.save(patches)\n    }\n  }\n\n  onDelete = (e) => {\n    e.preventDefault()\n    if(this.state.patches.length<=1)\n      return\n\n    const patches = this.state.patches.filter( (p,i) => i!==parseInt(this.state.current))\n    this.save(patches)\n  }\n\n  onLoadDefaults = (e) => {\n    e.preventDefault()\n    this.loadDefaultPatches()\n  }\n\n  onLeftClick = (e) => {\n    e.preventDefault()\n    const i = parseInt(this.state.current)\n    if(i>0){\n      this.setState({current:i-1})\n    }\n  }\n\n  onRightClick = (e) => {\n    e.preventDefault()\n    const i = parseInt(this.state.current)\n    if(i<this.state.patches.length-1){\n      this.setState({current:i+1})\n    }\n  }\n\n  onUploadClick = (e) => {\n    e.preventDefault()\n    this.refs.file.click()\n  }\n\n  render() {\n    return (\n      <nav>\n        <a href=\"/\" title=\"Previous Patch\" onClick={this.onLeftClick}><FaCaretLeft/></a>\n        <select value={this.state.current} onChange={this.onChange}>\n          {this.state.patches.map((p,i) =><option key={i} value={i}>{p.name}</option>)}\n        </select>\n        <a href=\"/\" title=\"Next Patch\" onClick={this.onRightClick}><FaCaretRight/></a>\n        <a href=\"/\" title=\"Save this Patch\" onClick={this.onSave}><FaSave/></a>\n        <a href=\"/\" title=\"Create new Patch\" onClick={this.onCreate}><FaPlus/></a>\n        <a href=\"/\" title=\"Upload Patches\" onClick={this.onUploadClick}><FaUpload/></a>\n        <a href=\"/\" title=\"Delete this Patch\" onClick={this.onDelete}><FaBackspace/></a>\n        <a href=\"/\" title=\"Load default Patches\" onClick={this.onLoadDefaults}><FaBomb/></a>\n        <input style={{display:'none'}} ref=\"file\" type=\"file\" accept=\".dmp\" multiple onChange={this.onChangeHandler} / >\n\n      </nav>\n    )\n  }\n}\n\n\nexport default Patches;\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\n\nclass Envelope extends React.Component {\n  static contextType = CV2612Context\n  constructor(props) {\n    super(props)\n    this.state = {}\n    this.code = `${props.ch}_${props.op}`\n  }\n\n  render() {\n    return (\n      <div className=\"envelope\">\n        <svg height=\"100\" width=\"400\" viewBox=\"0 0 400 100\" xmlns=\"http://www.w3.org/2000/svg\">\n          <polyline points={this.context.envelopes[this.code]} />\n        </svg>\n      </div>\n    )\n  }\n}\n\nEnvelope.defaultProps = {\n  ch: 6,\n  op: 4\n};\n\n\nexport default Envelope;\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\n\nclass Slider extends React.Component {\n  static contextType = CV2612Context\n  constructor(props) {\n    super(props)\n    this.code = `${props.ch}_${props.op}_${props.name}`\n    this.state = {}\n  }\n\n  componentWillMount(){\n    const map =this.context.mapping[this.code]\n    this.max = Math.pow(2,map.bits)-1\n  }\n\n  onChange = (ev) =>{\n    ev.preventDefault()\n    this.context.updateParam(this.code,parseInt(ev.target.value))\n    this.context.setActiveParameter(this.code)\n  }\n\n  onClick = (ev) =>{\n    ev.preventDefault()\n    this.context.setActiveParameter(this.code)\n  }\n\n  render() {\n    const m = this.context.mapping[this.code]\n    const mapped = ( (m.ch && m.cc)!==null)\n    let className = 'slider'\n    if(this.context.learning) className += ' learn'\n    if(this.context.activeParameter === this.code) className += ' active'\n    if(mapped) className += ' mapped'\n\n    return (\n      <div className={className} onClick={this.onClick} code={this.code}>\n        <label>{this.props.name}</label>\n        <input type=\"range\" step={1} min={0} max={this.max} value={this.context.params[this.code]}\n         onChange={this.onChange} />\n        <span>\n          {this.context.params[this.code] + (this.context.learning ? (mapped ? ` - ${m.ch}:${m.cc}` : ' - n/a'): '') }\n        </span>\n      </div>\n    )\n  }\n}\n\nSlider.defaultProps = {\n  env: false,\n  ch: 6,\n  op: 4\n}\n\nexport default Slider\n","import React from 'react'\nimport Envelope from \"./envelope\"\nimport Slider from \"./slider\"\nimport {CV2612Context} from \"./context\"\n\nclass Operator extends React.Component {\n  static contextType = CV2612Context\n\n  render() {\n    return (\n      <div className=\"operator\">\n        <h5>Op {this.props.op+1}</h5>\n        <Slider name=\"ar\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"d1\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"sl\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"d2\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"rr\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"tl\" ch={this.props.ch} op={this.props.op} />\n        <Envelope ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"mul\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"det\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"rs\" ch={this.props.ch} op={this.props.op} />\n        <Slider name=\"am\" ch={this.props.ch} op={this.props.op} />\n      </div>\n    )\n  }\n}\n\n\nOperator.defaultProps = {\n  ch: 6\n};\n\n\nexport default Operator;\n","import React from 'react'\nimport Operator from \"./operator\"\nimport Slider from \"./slider\"\nimport {CV2612Context} from \"./context\"\nimport algorithmAscii from \"./utils/algorithmAscii\"\n\nclass Channel extends React.Component {\n  static contextType = CV2612Context\n\n  render() {\n    return (\n      <div className=\"channel\">\n        <table>\n          <tbody>\n            <tr>\n              <td><Slider name=\"lfo\" /></td>\n              <td></td>\n              <td><Slider name=\"al\" ch={this.props.ch} /></td>\n              <td>\n                <pre className=\"algorithm\">\n                  {algorithmAscii(this.context.params[`${this.props.ch}_4_al`])}\n                </pre>\n              </td>\n            </tr>\n            <tr>\n              <td><Slider name=\"fb\"  ch={this.props.ch} /></td>\n              <td><Slider name=\"ams\" ch={this.props.ch} /></td>\n              <td><Slider name=\"fms\" ch={this.props.ch} /></td>\n              <td><Slider name=\"st\"  ch={this.props.ch} /></td>\n              <td></td>\n            </tr>\n            <tr>\n              <td><Operator ch={this.props.ch} op={0} /></td>\n              <td><Operator ch={this.props.ch} op={1} /></td>\n              <td><Operator ch={this.props.ch} op={2} /></td>\n              <td><Operator ch={this.props.ch} op={3} /></td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n    )\n  }\n}\n\nChannel.defaultProps = {\n  ch: 6\n}\n\nexport default Channel\n","export default function algorithmAscii(algorithm){\n  switch(algorithm) {\n    case 0:\n      return `\n\n\n\n   \n1234\n   \n\n\n\n`\n    case 1:\n    return `\n\n\n1\n     \n    34\n     \n2\n\n\n`\n    case 2:\n    return `\n\n     \n     1\n        \n         4\n     \n23\n  \n\n`\n    case 3:\n    return `\n\n  \n12\n     \n         4\n        \n     3\n     \n\n`\n    case 4:\n    return `\n\n  \n12\n   \n         \n   \n34\n  \n\n`\n    case 5:\n    return `\n      \n    2\n       \n    \n13\n    \n       \n    4\n      \n`\n    case 6:\n    return `\n   \n 12\n     \n        \n      3\n        \n        \n      4\n      \n`\n    case 7:\n    return `\n\n\n   \n1 2 3 4\n   \n \n       \n       \n\n`\n  default:\n      return 'no algorithm'\n  }\n}\n","import React from 'react'\nimport {CV2612Context} from \"./context\"\nimport Channel from \"./channel\"\n\nclass Channels extends React.Component {\n  static contextType = CV2612Context\n\n  onFilterChannel= (ev) => {\n    ev.preventDefault()\n    const ch = parseInt(ev.target.attributes.ch.value)\n    this.context.filterChannel(ch)\n  }\n\n  render() {\n    const f = this.context.filters\n    return (\n        <>\n          <nav>\n            <a href=\"/\" className={f.ch === 6 ? 'active':'' } ch={6} onClick={this.onFilterChannel} title=\"Show only Omni channel\">Omni Channel</a>\n            {[0,1,2,3,4,5].map(i => <a href=\"/\" className={f.ch === i ? 'active':'' } key={i} ch={i} onClick={this.onFilterChannel} title={\"Show only channel \"+(i+1)}>{i+1}</a>)}\n          </nav>\n          {[0,1,2,3,4,5,6].map(i => (f.ch === i) && <Channel key={i} ch={i} />)}\n        </>\n    )\n  }\n\n}\n\nexport default Channels\n","\nimport React from \"react\"\nimport CV2612Provider from \"./context\"\nimport Midi from \"./midi\"\nimport Sequencer from \"./sequencer\"\nimport Patches from \"./patches\"\nimport Channels from \"./channels\"\n\nclass Device extends React.Component {\n\n  render() {\n    return (\n        <CV2612Provider>\n          <Midi />\n          <Sequencer />\n          <Patches />\n          <Channels />\n        </CV2612Provider>\n    )\n  }\n}\n\nexport default Device\n","import React from \"react\"\nimport Layout from \"../layouts/cv2612\"\nimport SEO from \"../components/seo\"\nimport Device from \"../components/cv2612/device\"\n\n\nclass CV2612Index extends React.Component {\n  render() {\n    return (\n      <Layout location={this.props.location} >\n        <SEO title=\"cv2612\" />\n        <Device />\n      </Layout>\n    )\n  }\n}\n\nexport default CV2612Index\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport Link, {\n  withPrefix,\n  withAssetPrefix,\n  navigate,\n  push,\n  replace,\n  navigateTo,\n  parsePath,\n} from \"gatsby-link\"\nimport PageRenderer from \"./public-page-renderer\"\n\nconst StaticQueryContext = React.createContext({})\n\nconst StaticQuery = props => (\n  <StaticQueryContext.Consumer>\n    {staticQueryData => {\n      if (\n        props.data ||\n        (staticQueryData[props.query] && staticQueryData[props.query].data)\n      ) {\n        return (props.render || props.children)(\n          props.data ? props.data.data : staticQueryData[props.query].data\n        )\n      } else {\n        return <div>Loading (StaticQuery)</div>\n      }\n    }}\n  </StaticQueryContext.Consumer>\n)\n\nconst useStaticQuery = query => {\n  if (\n    typeof React.useContext !== `function` &&\n    process.env.NODE_ENV === `development`\n  ) {\n    throw new Error(\n      `You're likely using a version of React that doesn't support Hooks\\n` +\n        `Please update React and ReactDOM to 16.8.0 or later to use the useStaticQuery hook.`\n    )\n  }\n  const context = React.useContext(StaticQueryContext)\n  if (context[query] && context[query].data) {\n    return context[query].data\n  } else {\n    throw new Error(\n      `The result of this StaticQuery could not be fetched.\\n\\n` +\n        `This is likely a bug in Gatsby and if refreshing the page does not fix it, ` +\n        `please open an issue in https://github.com/gatsbyjs/gatsby/issues`\n    )\n  }\n}\n\nStaticQuery.propTypes = {\n  data: PropTypes.object,\n  query: PropTypes.string.isRequired,\n  render: PropTypes.func,\n  children: PropTypes.func,\n}\n\nfunction graphql() {\n  throw new Error(\n    `It appears like Gatsby is misconfigured. Gatsby related \\`graphql\\` calls ` +\n      `are supposed to only be evaluated at compile time, and then compiled away. ` +\n      `Unfortunately, something went wrong and the query was left in the compiled code.\\n\\n` +\n      `Unless your site has a complex or custom babel/Gatsby configuration this is likely a bug in Gatsby.`\n  )\n}\n\nexport {\n  Link,\n  withAssetPrefix,\n  withPrefix,\n  graphql,\n  parsePath,\n  navigate,\n  push, // TODO replace for v3\n  replace, // TODO remove replace for v3\n  navigateTo, // TODO: remove navigateTo for v3\n  StaticQueryContext,\n  StaticQuery,\n  PageRenderer,\n  useStaticQuery,\n}\n","const preferDefault = m => (m && m.default) || m\n\nif (process.env.BUILD_STAGE === `develop`) {\n  module.exports = preferDefault(require(`./public-page-renderer-dev`))\n} else if (process.env.BUILD_STAGE === `build-javascript`) {\n  module.exports = preferDefault(require(`./public-page-renderer-prod`))\n} else {\n  module.exports = () => null\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport Helmet from \"react-helmet\"\nimport { StaticQuery, graphql } from \"gatsby\"\n\nfunction SEO({ description, lang, meta, keywords, title }) {\n  return (\n    <StaticQuery\n      query={detailsQuery}\n      render={data => {\n        const metaDescription =\n          description || data.site.siteMetadata.description\n        return (\n          <Helmet\n            htmlAttributes={{\n              lang,\n            }}\n            title={title}\n            titleTemplate={`%s | ${data.site.siteMetadata.title}`}\n            meta={[\n              {\n                name: `description`,\n                content: metaDescription,\n              },\n              {\n                property: `og:title`,\n                content: title,\n              },\n              {\n                property: `og:description`,\n                content: metaDescription,\n              },\n              {\n                property: `og:type`,\n                content: `website`,\n              },\n              {\n                name: `twitter:card`,\n                content: `summary`,\n              },\n              {\n                name: `twitter:creator`,\n                content: data.site.siteMetadata.author,\n              },\n              {\n                name: `twitter:title`,\n                content: title,\n              },\n              {\n                name: `twitter:description`,\n                content: metaDescription,\n              },\n            ]\n              .concat(\n                keywords.length > 0\n                  ? {\n                      name: `keywords`,\n                      content: keywords.join(`, `),\n                    }\n                  : []\n              )\n              .concat(meta)}\n          />\n        )\n      }}\n    />\n  )\n}\n\nSEO.defaultProps = {\n  lang: `en`,\n  meta: [],\n  keywords: [],\n}\n\nSEO.propTypes = {\n  description: PropTypes.string,\n  lang: PropTypes.string,\n  meta: PropTypes.array,\n  keywords: PropTypes.arrayOf(PropTypes.string),\n  title: PropTypes.string.isRequired,\n}\n\nexport default SEO\n\nconst detailsQuery = graphql`\n  query DefaultSEOQuery {\n    site {\n      siteMetadata {\n        title\n        description\n        author\n      }\n    }\n  }\n`\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\n\nimport InternalPageRenderer from \"./page-renderer\"\nimport loader from \"./loader\"\n\nconst ProdPageRenderer = ({ location }) => {\n  const pageResources = loader.getResourcesForPathnameSync(location.pathname)\n  if (!pageResources) {\n    return null\n  }\n\n  return React.createElement(InternalPageRenderer, {\n    location,\n    pageResources,\n    ...pageResources.json,\n  })\n}\n\nProdPageRenderer.propTypes = {\n  location: PropTypes.shape({\n    pathname: PropTypes.string.isRequired,\n  }).isRequired,\n}\n\nexport default ProdPageRenderer\n","import React from \"react\"\nimport { Link } from \"gatsby\"\nimport PropTypes from 'prop-types'\n\nconst swaps = [['i','1'],['e','3'],['o','0'],['g','6'],['a','4']]\n\nclass Brand extends React.Component {\n\n  constructor(props){\n    super(props)\n    this.state = {title: props.title}\n  }\n\n  getDiff(){\n    let diff = 0\n    for(let i=0;i<this.props.title.length;i++){\n      diff += (this.state.title[i]===this.props.title[i]) ? 0 : 1\n    }\n    return diff\n  }\n\n  timer() {\n    let i = Math.floor(Math.random()*swaps.length)\n    let from = Math.round(Math.random())\n    if(this.getDiff()>3) from = 1\n    let to = from ? 0 : 1\n    if(Math.random()<0.5){\n      this.setState({\n        title: this.state.title.replace(swaps[i][from],swaps[i][to])\n      })\n    }\n  }\n\n  componentDidMount(){\n    this.intervalId = setInterval(this.timer.bind(this), 100);\n  }\n\n  componentWillUnmount(){\n    clearInterval(this.intervalId);\n  }\n\n  render() {\n    return (\n        <h1>\n          <Link to={`/`}>{this.state.title}</Link>\n        </h1>\n    )\n  }\n\n}\n\n\n\nBrand.propTypes = {\n  title: PropTypes.string.isRequired,\n};\n\n\nexport default Brand\n"],"sourceRoot":""}